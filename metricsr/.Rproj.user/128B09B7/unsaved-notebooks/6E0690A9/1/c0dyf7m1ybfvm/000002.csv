"0","getPalette <- colorRampPalette(brewer.pal(12, ""Accent""))"
"0","colourCount <- length(unique(migrants$cma))"
"0","for (i in 1:2) {"
"0","  print("
"0","    ggplot("
"0","      data = migrants %>%"
"0","        select("
"0","          ""sex"", ""vhome"", ""cma"", ""hhinc"","
"0","          ""marst"", ""occ81"", ""dgree"", ""relig"", ""mothertg"","
"0","          ""dtype"", ""ethnicor"""
"0","        ) %>%"
"0","        melt(id = ""cma"", na.rm = T),"
"0","      aes(x = value, fill = factor(cma)) # Can remove NAs because it's melted"
"0","    ) +"
"0","      geom_bar(aes(y = (..count..) / sum(..count..))) + "
"0","  scale_fill_manual(values = getPalette(colourCount)) +"
"0","      facet_wrap_paginate(~ variable,"
"0","        scales = ""free"", ncol = 2, nrow = 3, labeller = as_labeller("
"0","          c( # labels"
"0","            ""sex"" = ""Sex"","
"0","            ""vhome"" = ""Value of home"","
"0","            ""cma"" = ""Metropolitain Area"","
"0","            ""hhinc"" = ""Household: total income group"","
"0","            ""marst"" = ""Marital status"","
"0","            ""occ81"" = ""Occupation"","
"0","            ""dgree"" = ""Education: highest degree"","
"0","            ""relig"" = ""Religion"","
"0","            ""mothertg"" = ""Mother tongue"","
"0","            ""dtype"" = ""Dwelling: type"","
"0","            ""ethnicor"" = ""Ethnic origin"""
"0","          )"
"0","        ),"
"0","        page = i"
"0","      ) +"
"0","      ylab("""") +"
"0","      xlab("""") +"
"0","      ggtitle(""Bar plots for factor variables (subset: migrants)"") +"
"0","      coord_flip() +"
"0","      theme(plot.title = element_text(hjust = 0)) +"
"0","      labs(fill = ""CMA"") +"
"0","      theme(legend.position = ""bottom"") + theme_light()"
"0","  )"
"0","}"
